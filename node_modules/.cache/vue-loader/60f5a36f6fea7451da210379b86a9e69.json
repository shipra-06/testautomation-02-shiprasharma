{"remainingRequest":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\src\\views\\Reservation.vue?vue&type=script&lang=ts&","dependencies":[{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\src\\views\\Reservation.vue","mtime":1617789068380},{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\course\\02-pass-shiprasharma\\rasi10-hotel-test-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IENvbXBvbmVudCwgVnVlLCBXYXRjaCB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InCmltcG9ydCB7IGNoZWNrTG9nZ2VkSW4sIGdldEFsbCwgZ2V0UmVzZXJ2YXRpb24sIGNyZWF0ZVJlc2VydmF0aW9uLCBlZGl0UmVzZXJ2YXRpb24sIGRlbGV0ZVJlc2VydmF0aW9uIH0gZnJvbSAnQC9zZXJ2aWNlcy9hcGknCmltcG9ydCB7IHZhbGlkYXRlRGF0ZSB9IGZyb20gJ0Avc2VydmljZXMvdmFsaWRhdGUnCmltcG9ydCBMb2FkaW5nIGZyb20gJ0AvY29tcG9uZW50cy9Mb2FkaW5nLnZ1ZScKaW1wb3J0IENoZWNrQm94IGZyb20gJ0AvY29tcG9uZW50cy9DaGVja0JveC52dWUnCmltcG9ydCB7IFJlc2VydmF0aW9uIH0gZnJvbSAnQC90eXBlcycKCkBDb21wb25lbnQoewoJY29tcG9uZW50czogeyBMb2FkaW5nLCBDaGVja0JveCB9Cn0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlc2VydmF0aW9uQ29tcG9uZW50IGV4dGVuZHMgVnVlIHsKCXB1YmxpYyBsb2FkaW5nOiBib29sZWFuID0gZmFsc2UKCXB1YmxpYyBzYXZpbmc6IGJvb2xlYW4gPSBmYWxzZQoJcHVibGljIGRlbGV0aW5nOiBib29sZWFuID0gZmFsc2UKCXB1YmxpYyByZXNlcnZhdGlvbjogUmVzZXJ2YXRpb24gPSB7fQoJcHVibGljIGVycm9yczogc3RyaW5nW10gPSBbXQoJcHVibGljIGRpcnR5OiBib29sZWFuID0gZmFsc2UKCglwdWJsaWMgZ2V0IGNsaWVudHMoKSB7CgkJcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmNsaWVudHMKCX0KCglwdWJsaWMgZ2V0IHJvb21zKCkgewoJCXJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tcwoJfQoKCXB1YmxpYyBnZXQgYmlsbHMoKSB7CgkJcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmJpbGxzCgl9CgoKCXByaXZhdGUgYXN5bmMgY3JlYXRlZCgpIHsKCQlpZiAoY2hlY2tMb2dnZWRJbigpKSB7CgoJCQlhd2FpdCBnZXRBbGwoKQoKCQkJaWYgKHRoaXMubW9kZSA9PT0gJ2NyZWF0ZScpIHsKCQkJCXRoaXMucmVzZXJ2YXRpb24gPSB7CgkJCQkJY2xpZW50OiAnJywKCQkJCQlyb29tOiAnJywKCQkJCQliaWxsOiAnJwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJdGhpcy5sb2FkaW5nID0gdHJ1ZQoJCQkJdGhpcy5yZXNlcnZhdGlvbiA9IGF3YWl0IGdldFJlc2VydmF0aW9uKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkKCQkJCXRoaXMubG9hZGluZyA9IGZhbHNlCgkJCX0KCQl9Cgl9CgoJcHVibGljIGdldCBtb2RlKCkgewoJCXJldHVybiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09ICduZXcnID8gJ2NyZWF0ZScgOiAnZWRpdCcKCX0KCglwcml2YXRlIHZhbGlhdGUoKSB7CgkJdGhpcy5lcnJvcnMgPSBbXQoKCQlpZiAoIXRoaXMucmVzZXJ2YXRpb24uc3RhcnQgfHwgdGhpcy5yZXNlcnZhdGlvbi5zdGFydC5sZW5ndGggPT09IDApIHsKCQkJdGhpcy5lcnJvcnMucHVzaCgnU3RhcnQgZGF0ZSBtdXN0IGJlIHNldCcpCgkJfSBlbHNlIGlmICghdmFsaWRhdGVEYXRlKHRoaXMucmVzZXJ2YXRpb24uc3RhcnQpKSB7CgkJCXRoaXMuZXJyb3JzLnB1c2goJ1N0YXJ0IGRhdGUgaXMgbm90IHZhbGlkJykKCQl9CgoJCWlmICghdGhpcy5yZXNlcnZhdGlvbi5lbmQgfHwgdGhpcy5yZXNlcnZhdGlvbi5lbmQubGVuZ3RoID09PSAwKSB7CgkJCXRoaXMuZXJyb3JzLnB1c2goJ0VuZCBkYXRlIG11c3QgYmUgc2V0JykKCQl9IGVsc2UgaWYgKCF2YWxpZGF0ZURhdGUodGhpcy5yZXNlcnZhdGlvbi5lbmQpKSB7CgkJCXRoaXMuZXJyb3JzLnB1c2goJ0VuZCBkYXRlIGlzIG5vdCB2YWxpZCcpCgkJfQoKCQlpZiAodGhpcy5yZXNlcnZhdGlvbi5jbGllbnQgIT09ICcnICYmICF0aGlzLmNsaWVudHMuZmluZCgoYykgPT4gYy5pZCA9PT0gdGhpcy5yZXNlcnZhdGlvbi5jbGllbnQpKSB7CgkJCXRoaXMuZXJyb3JzLnB1c2goJ1BsZWFzZSBzZWxlY3QgYSB2YWxpZCBjbGllbnQnKQoJCX0KCgkJaWYgKHRoaXMucmVzZXJ2YXRpb24ucm9vbSAhPT0gJycgJiYgIXRoaXMucm9vbXMuZmluZCgoYykgPT4gYy5pZCA9PT0gdGhpcy5yZXNlcnZhdGlvbi5yb29tKSkgewoJCQl0aGlzLmVycm9ycy5wdXNoKCdQbGVhc2Ugc2VsZWN0IGEgdmFsaWQgcm9vbScpCgkJfQoKCQlpZiAodGhpcy5yZXNlcnZhdGlvbi5iaWxsICE9PSAnJyAmJiAhdGhpcy5iaWxscy5maW5kKChjKSA9PiBjLmlkID09PSB0aGlzLnJlc2VydmF0aW9uLmJpbGwpKSB7CgkJCXRoaXMuZXJyb3JzLnB1c2goJ1BsZWFzZSBzZWxlY3QgYSB2YWxpZCBiaWxsJykKCQl9CgoJCXJldHVybiB0aGlzLmVycm9ycy5sZW5ndGggPT09IDAKCX0KCglAV2F0Y2goJ3Jlc2VydmF0aW9uJywgeyBkZWVwOiB0cnVlIH0pCglwcml2YXRlIGNsZWFyRXJyb3JzKCkgewoJCWlmICh0aGlzLmRpcnR5KSB7CgkJCXRoaXMudmFsaWF0ZSgpCgkJfQoJfQoKCXB1YmxpYyBhc3luYyBzYXZlKCkgewoJCXRoaXMuZGlydHkgPSB0cnVlCgkJaWYgKCF0aGlzLnZhbGlhdGUoKSkgewoJCQlyZXR1cm4gZmFsc2UKCQl9CgkJdGhpcy5zYXZpbmcgPSB0cnVlCgkJaWYgKHRoaXMubW9kZSA9PT0gJ2NyZWF0ZScpIHsKCQkJdGhpcy5yZXNlcnZhdGlvbiA9IGF3YWl0IGNyZWF0ZVJlc2VydmF0aW9uKHRoaXMucmVzZXJ2YXRpb24pCgkJfSBlbHNlIHsKCQkJdGhpcy5yZXNlcnZhdGlvbiA9IGF3YWl0IGVkaXRSZXNlcnZhdGlvbih0aGlzLnJlc2VydmF0aW9uLmlkLCB0aGlzLnJlc2VydmF0aW9uKQoJCX0KCQl0aGlzLiRyb3V0ZXIucHVzaCgnL3Jlc2VydmF0aW9ucycpCgl9CgoJcHVibGljIGFzeW5jIHJlbW92ZSgpIHsKCQl0aGlzLmRlbGV0aW5nID0gdHJ1ZQoJCWF3YWl0IGRlbGV0ZVJlc2VydmF0aW9uKHRoaXMucmVzZXJ2YXRpb24uaWQpCgkJdGhpcy4kcm91dGVyLnB1c2goJy9yZXNlcnZhdGlvbnMnKQoJfQoKfQo="},{"version":3,"sources":["Reservation.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"Reservation.vue","sourceRoot":"src/views","sourcesContent":["<script lang=\"ts\">\r\n\timport { Component, Vue, Watch } from 'vue-property-decorator'\r\n\timport { checkLoggedIn, getAll, getReservation, createReservation, editReservation, deleteReservation } from '@/services/api'\r\n\timport { validateDate } from '@/services/validate'\r\n\timport Loading from '@/components/Loading.vue'\r\n\timport CheckBox from '@/components/CheckBox.vue'\r\n\timport { Reservation } from '@/types'\r\n\r\n\t@Component({\r\n\t\tcomponents: { Loading, CheckBox }\r\n\t})\r\n\texport default class ReservationComponent extends Vue {\r\n\t\tpublic loading: boolean = false\r\n\t\tpublic saving: boolean = false\r\n\t\tpublic deleting: boolean = false\r\n\t\tpublic reservation: Reservation = {}\r\n\t\tpublic errors: string[] = []\r\n\t\tpublic dirty: boolean = false\r\n\r\n\t\tpublic get clients() {\r\n\t\t\treturn this.$store.state.clients\r\n\t\t}\r\n\r\n\t\tpublic get rooms() {\r\n\t\t\treturn this.$store.state.rooms\r\n\t\t}\r\n\r\n\t\tpublic get bills() {\r\n\t\t\treturn this.$store.state.bills\r\n\t\t}\r\n\r\n\r\n\t\tprivate async created() {\r\n\t\t\tif (checkLoggedIn()) {\r\n\r\n\t\t\t\tawait getAll()\r\n\r\n\t\t\t\tif (this.mode === 'create') {\r\n\t\t\t\t\tthis.reservation = {\r\n\t\t\t\t\t\tclient: '',\r\n\t\t\t\t\t\troom: '',\r\n\t\t\t\t\t\tbill: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.loading = true\r\n\t\t\t\t\tthis.reservation = await getReservation(this.$route.params.id)\r\n\t\t\t\t\tthis.loading = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic get mode() {\r\n\t\t\treturn this.$route.params.id === 'new' ? 'create' : 'edit'\r\n\t\t}\r\n\r\n\t\tprivate valiate() {\r\n\t\t\tthis.errors = []\r\n\r\n\t\t\tif (!this.reservation.start || this.reservation.start.length === 0) {\r\n\t\t\t\tthis.errors.push('Start date must be set')\r\n\t\t\t} else if (!validateDate(this.reservation.start)) {\r\n\t\t\t\tthis.errors.push('Start date is not valid')\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.reservation.end || this.reservation.end.length === 0) {\r\n\t\t\t\tthis.errors.push('End date must be set')\r\n\t\t\t} else if (!validateDate(this.reservation.end)) {\r\n\t\t\t\tthis.errors.push('End date is not valid')\r\n\t\t\t}\r\n\r\n\t\t\tif (this.reservation.client !== '' && !this.clients.find((c) => c.id === this.reservation.client)) {\r\n\t\t\t\tthis.errors.push('Please select a valid client')\r\n\t\t\t}\r\n\r\n\t\t\tif (this.reservation.room !== '' && !this.rooms.find((c) => c.id === this.reservation.room)) {\r\n\t\t\t\tthis.errors.push('Please select a valid room')\r\n\t\t\t}\r\n\r\n\t\t\tif (this.reservation.bill !== '' && !this.bills.find((c) => c.id === this.reservation.bill)) {\r\n\t\t\t\tthis.errors.push('Please select a valid bill')\r\n\t\t\t}\r\n\r\n\t\t\treturn this.errors.length === 0\r\n\t\t}\r\n\r\n\t\t@Watch('reservation', { deep: true })\r\n\t\tprivate clearErrors() {\r\n\t\t\tif (this.dirty) {\r\n\t\t\t\tthis.valiate()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic async save() {\r\n\t\t\tthis.dirty = true\r\n\t\t\tif (!this.valiate()) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tthis.saving = true\r\n\t\t\tif (this.mode === 'create') {\r\n\t\t\t\tthis.reservation = await createReservation(this.reservation)\r\n\t\t\t} else {\r\n\t\t\t\tthis.reservation = await editReservation(this.reservation.id, this.reservation)\r\n\t\t\t}\r\n\t\t\tthis.$router.push('/reservations')\r\n\t\t}\r\n\r\n\t\tpublic async remove() {\r\n\t\t\tthis.deleting = true\r\n\t\t\tawait deleteReservation(this.reservation.id)\r\n\t\t\tthis.$router.push('/reservations')\r\n\t\t}\r\n\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"container\">\r\n\t\t<h2>\r\n\t\t\t<div v-if=\"mode === 'create'\">New Reservation</div>\r\n\t\t\t<div v-if=\"mode === 'edit'\">Reservation: {{ $route.params.id }}</div>\r\n\t\t\t<a v-if=\"mode === 'edit'\" class=\"btn red\" @click=\"remove\">{{ deleting ? '...' : 'Delete' }}</a>\r\n\t\t</h2>\r\n\t\t<Loading v-if=\"loading\" />\r\n\t\t<div v-if=\"!loading\">\r\n\t\t\t<div class=\"field\" v-if=\"mode === 'edit'\">\r\n\t\t\t\t<label>ID</label>\r\n\t\t\t\t<input type=\"text\" disabled :value=\"reservation.id\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"field\" v-if=\"mode === 'edit'\">\r\n\t\t\t\t<label>Created</label>\r\n\t\t\t\t<input type=\"text\" disabled :value=\"reservation.created\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"field\">\r\n\t\t\t\t<label>Start <small>(Format YYYY-MM-DD)</small></label>\r\n\t\t\t\t<input type=\"text\" v-model=\"reservation.start\" placeholder=\"YYYY-MM-DD\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"field\">\r\n\t\t\t\t<label>End <small>(Format YYYY-MM-DD)</small></label>\r\n\t\t\t\t<input type=\"text\" v-model=\"reservation.end\" placeholder=\"YYYY-MM-DD\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"field\">\r\n\t\t\t\t<label>Client</label>\r\n\t\t\t\t<select v-model=\"reservation.client\">\r\n\t\t\t\t\t<option value=\"\">- Not selected -</option>\r\n\t\t\t\t\t<option v-for=\"client in clients\" :key=\"client.id\" :value=\"client.id\">{{ client.name }} (#{{ client.id }})</option>\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"field\">\r\n\t\t\t\t<label>Room</label>\r\n\t\t\t\t<select v-model=\"reservation.room\">\r\n\t\t\t\t\t<option value=\"\">- Not selected -</option>\r\n\t\t\t\t\t<option v-for=\"room in rooms\" :key=\"room.id\" :value=\"room.id\">Floor {{ room.floor }}, Room {{ room.number }}</option>\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"field\">\r\n\t\t\t\t<label>Bill</label>\r\n\t\t\t\t<select v-model=\"reservation.bill\">\r\n\t\t\t\t\t<option value=\"\">- Not selected -</option>\r\n\t\t\t\t\t<option v-for=\"bill in bills\" :key=\"bill.id\" :value=\"bill.id\">ID: {{ bill.id }}</option>\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"error\" v-for=\"(error, i) in errors\" :key=\"i\">{{ error }}</div>\r\n\t\t<div class=\"actions\">\r\n\t\t\t<router-link class=\"btn\" to=\"/reservations\">Back</router-link>\r\n\t\t\t<a class=\"btn blue\" @click=\"save\">{{ saving ? '...' : 'Save' }}</a>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n\th2 {\r\n\t\tposition: relative;\r\n\t\ta {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 0;\r\n\t\t\tright: 0;\r\n\t\t}\r\n\t}\r\n\t.actions {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n</style>\r\n"]}]}